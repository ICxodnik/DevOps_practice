# –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç - Lesson-7

–¶–µ–π –≥—ñ–¥ –¥–æ–ø–æ–º–æ–∂–µ –≤–∞–º —à–≤–∏–¥–∫–æ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏ –ø–æ–≤–Ω—É —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑ Django –∑–∞—Å—Ç–æ—Å—É–Ω–∫–æ–º –Ω–∞ AWS.

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç (5 –∫—Ä–æ–∫—ñ–≤)

### –ö—Ä–æ–∫ 1: –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞
```bash
# –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —É –≤–∞—Å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏
aws --version
terraform --version
kubectl version --client
helm version
docker --version
```

### –ö—Ä–æ–∫ 2: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏
```bash
cd lesson-7

# –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏
terraform init
terraform plan
terraform apply
```

### –ö—Ä–æ–∫ 3: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è kubectl
```bash
# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è kubectl –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ EKS –∫–ª–∞—Å—Ç–µ—Ä–æ–º
./scripts/setup-kubectl.sh
```

### –ö—Ä–æ–∫ 4: –ó–±—ñ—Ä–∫–∞ —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è Docker –æ–±—Ä–∞–∑—É
```bash
# –ó–±—ñ—Ä–∫–∞ —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è Django –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É –≤ ECR
./scripts/build-and-push.sh
```

### –ö—Ä–æ–∫ 5: –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É
```bash
# –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è Django –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É —á–µ—Ä–µ–∑ Helm
./scripts/deploy.sh
```

## ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–±–æ—Ç–∏

### –û—Ç—Ä–∏–º–∞–Ω–Ω—è URL –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É
```bash
kubectl get svc django-app -o jsonpath='{.status.loadBalancer.ingress[0].hostname}'
```

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ–¥—ñ–≤
kubectl get pods -l app.kubernetes.io/name=django-app

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å–µ—Ä–≤—ñ—Å—ñ–≤
kubectl get svc django-app

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ HPA
kubectl get hpa django-app
```

### –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤
```bash
kubectl logs -l app.kubernetes.io/name=django-app
```

## üßπ –û—á–∏—â–µ–Ω–Ω—è

### –í–∏–¥–∞–ª–µ–Ω–Ω—è –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É
```bash
helm uninstall django-app
```

### –í–∏–¥–∞–ª–µ–Ω–Ω—è —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏
```bash
terraform destroy
```

## üîß –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–î–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è Django –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É –ª–æ–∫–∞–ª—å–Ω–æ:

```bash
cd django-app
./test-local.sh
```

–ó–∞—Å—Ç–æ—Å—É–Ω–æ–∫ –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–∞ –∞–¥—Ä–µ—Å–æ—é: http://localhost:8000

## üìã –í–∞–∂–ª–∏–≤—ñ URL

- **Django –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫**: http://[load-balancer-url]
- **Health check**: http://[load-balancer-url]/health/
- **ECR —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π**: [aws-account-id].dkr.ecr.us-west-2.amazonaws.com/lesson-7-ecr

## ‚ö†Ô∏è –í–∞–∂–ª–∏–≤—ñ –∑–∞—É–≤–∞–∂–µ–Ω–Ω—è

1. **AWS Account ID**: –ù–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ –≤ `charts/django-app/values.yaml`
2. **–†–µ–≥—ñ–æ–Ω**: –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `us-west-2`
3. **–í–∞—Ä—Ç—ñ—Å—Ç—å**: EKS –∫–ª–∞—Å—Ç–µ—Ä —Ç–∞ LoadBalancer —î –ø–ª–∞—Ç–Ω–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏
4. **–ë–µ–∑–ø–µ–∫–∞**: –ó–º—ñ–Ω—ñ—Ç—å `SECRET_KEY` –≤ values.yaml –¥–ª—è production

## üÜò –í–∏—Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: kubectl –Ω–µ –º–æ–∂–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞
```bash
aws eks update-kubeconfig --region us-west-2 --name lesson-7-eks-cluster
```

### –ü—Ä–æ–±–ª–µ–º–∞: Docker –Ω–µ –º–æ–∂–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –æ–±—Ä–∞–∑ –≤ ECR
```bash
aws ecr get-login-password --region us-west-2 | docker login --username AWS --password-stdin [aws-account-id].dkr.ecr.us-west-2.amazonaws.com
```

### –ü—Ä–æ–±–ª–µ–º–∞: Helm –Ω–µ –º–æ–∂–µ –∑–Ω–∞–π—Ç–∏ —á–∞—Ä—Ç
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ –≤–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó
pwd  # –ü–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ lesson-7
ls charts/django-app/  # –ü–æ–≤–∏–Ω–µ–Ω –ø–æ–∫–∞–∑–∞—Ç–∏ —Ñ–∞–π–ª–∏ —á–∞—Ä—Ç—É
``` 